{
  "entities": {
    "CreditCardTransaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CreditCardTransaction",
      "type": "object",
      "description": "Represents a single credit card transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the credit card transaction."
        },
        "transactionDate": {
          "type": "string",
          "description": "The date the transaction occurred."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction."
        },
        "description": {
          "type": "string",
          "description": "Description of the transaction."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction. Positive values are charges, negative values are credits."
        },
        "bankCode": {
          "type": "string",
          "description": "The bank code or any other remark for the transaction."
        }
      },
      "required": [
        "id",
        "transactionDate",
        "category",
        "description",
        "amount"
      ]
    },
    "DepositAccountTransaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DepositAccountTransaction",
      "type": "object",
      "description": "Represents a single transaction in a deposit account.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the deposit account transaction."
        },
        "date": {
          "type": "string",
          "description": "The date the transaction occurred."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction."
        },
        "description": {
          "type": "string",
          "description": "Description of the transaction."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction. Positive values are debits, negative values are credits."
        },
        "bankCode": {
          "type": "string",
          "description": "The bank code of the other party involved in the transaction, if applicable."
        },
        "accountNumber": {
          "type": "string",
          "description": "The account number of the other party involved in the transaction, if applicable."
        }
      },
      "required": [
        "id",
        "date",
        "category",
        "description",
        "amount"
      ]
    },
    "CashTransaction": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "CashTransaction",
      "type": "object",
      "description": "Represents a single cash transaction.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the cash transaction."
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "The date the transaction occurred."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction."
        },
        "description": {
          "type": "string",
          "description": "Description of the transaction."
        },
        "amount": {
          "type": "number",
          "description": "The amount of the transaction. Positive values are expenses, negative values are income."
        },
        "notes": {
          "type": "string",
          "description": "Any additional notes or remarks for the transaction."
        }
      },
      "required": [
        "id",
        "date",
        "category",
        "description",
        "amount"
      ]
    },
    "AppSettings": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AppSettings",
      "type": "object",
      "description": "Stores user-specific application settings, including rules and filters.",
      "properties": {
        "replacementRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "find": { "type": "string" },
              "replace": { "type": "string" },
              "deleteRow": { "type": "boolean" }
            },
            "required": ["find", "replace"]
          }
        },
        "categoryRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "keyword": { "type": "string" },
              "category": { "type": "string" }
            },
            "required": ["keyword", "category"]
          }
        },
        "quickFilters": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "categories": { "type": "array", "items": { "type": "string" } }
            },
            "required": ["name", "categories"]
          }
        },
        "availableCategories": {
          "type": "array",
          "items": { "type": "string" }
        },
        "cashTransactionDescriptions": {
          "type": "array",
          "items": { "type": "string" },
          "description": "A list of predefined descriptions for cash transactions."
        }
      }
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}/creditCardTransactions/{transactionId}",
        "definition": {
          "entityName": "CreditCardTransaction",
          "schema": {
            "$ref": "#/backend/entities/CreditCardTransaction"
          },
          "description": "Stores individual credit card transactions for a specific user. Authorization is based on path ownership, ensuring only the user can access their own transactions.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "transactionId",
              "description": "The unique identifier of the credit card transaction."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/depositAccountTransactions/{transactionId}",
        "definition": {
          "entityName": "DepositAccountTransaction",
          "schema": {
            "$ref": "#/backend/entities/DepositAccountTransaction"
          },
          "description": "Stores individual deposit account transactions for a specific user. Authorization is based on path ownership, ensuring only the user can access their own transactions.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "transactionId",
              "description": "The unique identifier of the deposit account transaction."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/cashTransactions/{transactionId}",
        "definition": {
          "entityName": "CashTransaction",
          "schema": {
            "$ref": "#/backend/entities/CashTransaction"
          },
          "description": "Stores individual cash transactions for a specific user. Authorization is based on path ownership.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "transactionId",
              "description": "The unique identifier of the cash transaction."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/settings/{settingId}",
        "definition": {
          "entityName": "AppSettings",
          "schema": {
            "$ref": "#/backend/entities/AppSettings"
          },
          "description": "Stores user-specific settings. A single document per user identified by a fixed ID like 'user-settings'.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "settingId",
              "description": "A fixed ID for the settings document, e.g., 'user-settings'."
            }
          ]
        }
      }
    ],
    "reasoning": "This design prioritizes user-owned data with path-based ownership, ensuring strong security and efficient querying. It leverages subcollections under the `users` collection to store credit card, deposit account, and cash transactions. This eliminates the need for complex security rules based on data content and ensures that only the authenticated user can access their own transaction data. Each user has dedicated subcollections for 'creditCardTransactions', 'depositAccountTransactions', and 'cashTransactions'. This segregation simplifies security rules, as each collection has a homogeneous security posture (private to the user). This structure directly supports Authorization Independence because each document is implicitly authorized via its path. No denormalization is needed because authorization is directly derived from the path. This structure supports QAPs (Rules are not Filters) because list operations are scoped to the user's collections, enabling secure and efficient data retrieval."
  }
}
